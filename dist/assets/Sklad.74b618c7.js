import{j as d,c as e,u as S,R as j,a as M,r as m,m as U,I as R,P as y,Z as $,C as q,a4 as A,E as z,T as K,d as H,e as Q,Y as J,a3 as W}from"./index.b7d8f67d.js";import{l as tt,a as et,b as ut,c as nt,d as at,e as it,f as lt,g as X,h as G,i as ot,j as rt,k as st,m as ct,n as dt,I as ft}from"./export.399be9e4.js";function Y(a){return d("div",{className:"groupbox",children:[e("div",{className:"groupbox-caption",children:a.caption}),a.children]})}function ht(){var b,V,_,O;const{permissions:a}=S(Q),n=a.get(j.SKLAD_STOL),h=M(tt),c=M(et),r=M(ut),f=M(nt),g=M(at),p=M(it),s=S(lt),E=[...new Set(s.map(u=>u.id))],l=S(X),[{filterId:x,filterMinLength:I,filterMaxLength:C},B]=m.exports.useState({filterId:0,filterMinLength:0,filterMaxLength:4e3}),D=s.filter(u=>((u==null?void 0:u.id)===x||x===0)&&(u==null?void 0:u.length)>=I&&(u==null?void 0:u.length)<=C),[T,v]=m.exports.useState(0),t=[{caption:"\u0421\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0430"},{caption:"\u0414\u043B\u0438\u043D\u0430"},{caption:"\u041A\u043E\u043B-\u0432\u043E"}],o=D.map((u,i)=>({key:i,data:[l.get(u.id),u.length,u.amount]})),Z=[{title:"\u0421\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0430:",value:(b=D[T])==null?void 0:b.id,displayValue:u=>l.get(u)||"",message:U.ENTER_CAPTION,inputType:R.LIST,list:[...l.keys()]},{title:"\u0414\u043B\u0438\u043D\u0430:",value:(V=D[T])==null?void 0:V.length,message:U.ENTER_CODE,inputType:R.TEXT,propertyType:y.INTEGER_POSITIVE_NUMBER,checkValue:u=>({success:u>0,message:"\u0414\u043B\u0438\u043D\u0430 \u0434\u043E\u043B\u0436\u043D\u0430 \u0431\u044B\u0442\u044C \u0431\u043E\u043B\u044C\u0448\u0435 0"})},{title:"\u041A\u043E\u043B-\u0432\u043E:",value:(_=D[T])==null?void 0:_.amount,inputType:R.TEXT,propertyType:y.INTEGER_POSITIVE_NUMBER,checkValue:u=>({success:u>0,message:"\u041A\u043E\u043B-\u0432\u043E \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0431\u043E\u043B\u044C\u0448\u0435 0"})}];return m.exports.useEffect(()=>{h(),c(),r(!0),r(!1)},[]),d($,{children:[e("hr",{}),e("br",{}),d(Y,{caption:"\u0424\u0438\u043B\u044C\u0442\u0440",children:[e("hr",{}),e(q,{value:x,items:E,displayValue:u=>l.get(u),onChange:u=>B(i=>({...i,filterId:u||0})),withEmpty:!0,styles:{width:"fit-content"}}),e("hr",{}),d("div",{className:"d-flex align-items-center gap-1",children:[e("div",{children:"\u0414\u043B\u0438\u043D\u0430 \u043E\u0442"}),e(A,{type:y.INTEGER_POSITIVE_NUMBER,value:I,min:0,max:1e4,setValue:u=>B(i=>({...i,filterMinLength:+u||0})),width:"60px"}),e("div",{children:"\u0434\u043E"}),e(A,{type:y.INTEGER_POSITIVE_NUMBER,value:C,min:0,max:1e4,setValue:u=>B(i=>({...i,filterMaxLength:+u||0})),width:"60px"})]}),e("input",{type:"button",value:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",onClick:()=>B({filterId:0,filterMinLength:0,filterMaxLength:4e3})})]}),e("hr",{}),d(z,{children:[e("div",{children:e(K,{header:t,content:o,onSelectRow:u=>{v(u)}})}),n!=null&&n.Update?e(H,{name:(O=D[T])==null?void 0:O.id,items:Z,dontUseCheckBoxes:!0,onUpdate:n!=null&&n.Update?{caption:"\u0423\u0431\u0440\u0430\u0442\u044C \u0441\u043E \u0441\u043A\u043B\u0430\u0434\u0430",question:u=>gt(u),onAction:async(u,i)=>{const L=i[0],k=+i[1],w=+i[2],F=await g({id:L,length:k,amount:w});return v(0),F}}:void 0,onAdd:n!=null&&n.Update?{caption:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u0430 \u0441\u043A\u043B\u0430\u0434",question:u=>pt(u),onAction:async(u,i)=>{const L=i[0],k=+i[1],w=+i[2];return await f({id:L,length:k,amount:w})}}:void 0,onDelete:n!=null&&n.Delete?{caption:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u0432\u0441\u0435 \u0441\u043F\u0438\u0441\u043A\u0438",question:()=>"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u0441\u0435 \u0434\u0430\u043D\u043D\u044B\u0435?",onAction:async(u,i)=>await p()}:void 0}):e("div",{})]})]})}function gt(a){return`\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0443 ${a[0]}     ${a[1]}\u043C\u043C  ${a[2]}\u0448\u0442?`}function pt(a){return`\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0443 ${a[0]}    ${a[1]}\u043C\u043C  ${a[2]}\u0448\u0442?`}function P({income:a}){var v;const n=a?S(st):S(ct),h=S(X),c=[...new Set(n.map(t=>t.id))],r=n.map(t=>t.date).reduce((t,o)=>t>o?o:t,(v=n[0])==null?void 0:v.date),{filterId:f,filterMinLength:g,filterMaxLength:p,filterMinDate:s,filterMaxDate:E,setFilter:l}=Et(a,r),x=n.filter(t=>((t==null?void 0:t.id)===f||f===0)&&(t==null?void 0:t.length)>=g&&(t==null?void 0:t.length)<=p&&(t==null?void 0:t.date)>=s&&(t==null?void 0:t.date)<=E),I=G(s),C=G(E),B=[{caption:"\u0414\u0430\u0442\u0430"},{caption:"\u0421\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0430"},{caption:"\u0414\u043B\u0438\u043D\u0430"},{caption:"\u041A\u043E\u043B-\u0432\u043E"}],D=x.map(t=>({key:t.id,data:[ot(t.date),h.get(t.id),t.length,t.amount]}));return m.exports.useEffect(()=>{l(t=>({...t,filterMinDate:r}))},[r]),d("div",{className:"sklad-container",children:[e("hr",{}),e("br",{}),d(Y,{caption:"\u0424\u0438\u043B\u044C\u0442\u0440",children:[e("hr",{}),e(q,{value:f,items:c,displayValue:t=>h.get(t),onChange:t=>l(o=>({...o,filterId:t||0})),withEmpty:!0,styles:{width:"fit-content"}}),e("hr",{}),d("div",{className:"d-flex align-items-center gap-1",children:[e("div",{children:"\u0414\u043B\u0438\u043D\u0430 \u043E\u0442"}),e(A,{type:y.INTEGER_POSITIVE_NUMBER,value:g,min:0,max:1e4,setValue:t=>l(o=>({...o,filterMinLength:+t||0})),width:"60px"}),e("div",{children:"\u0434\u043E"}),e(A,{type:y.INTEGER_POSITIVE_NUMBER,value:p,min:0,max:1e4,setValue:t=>l(o=>({...o,filterMaxLength:+t||0})),width:"60px"})]}),d("div",{className:"d-flex align-items-center gap-1 justify-content-stretch",children:[e("input",{type:"date",value:I,onChange:t=>l(o=>({...o,filterMinDate:new Date(t.target.value).valueOf()}))}),e("div",{className:"text-nowrap",children:"<---->"}),e("input",{type:"date",value:C,onChange:t=>l(o=>({...o,filterMaxDate:rt(t.target.value)}))})]}),e("input",{type:"button",value:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",onClick:()=>l({filterId:0,filterMinLength:0,filterMaxLength:4e3,filterMinDate:r,filterMaxDate:Date.now()})})]}),e("hr",{}),e(K,{header:B,content:D})]})}function Et(a,n){const[{filterId:h,filterMinLength:c,filterMaxLength:r,filterMinDate:f,filterMaxDate:g},p]=m.exports.useState({filterId:0,filterMinLength:0,filterMaxLength:4e3,filterMinDate:n,filterMaxDate:Date.now()}),[{filterId:s,filterMinLength:E,filterMaxLength:l,filterMinDate:x,filterMaxDate:I},C]=m.exports.useState({filterId:0,filterMinLength:0,filterMaxLength:4e3,filterMinDate:n,filterMaxDate:Date.now()});return{filterId:a?h:s,filterMinLength:a?c:E,filterMaxLength:a?r:l,filterMinDate:a?f:x,filterMaxDate:a?g:I,setFilter:a?p:C}}const N=new Map;N.set(1,"\u0421\u043A\u043B\u0430\u0434");N.set(2,"\u041F\u0440\u0438\u0445\u043E\u0434");N.set(3,"\u0420\u0430\u0441\u0445\u043E\u0434");function St(){const a=M(dt),n=J(),{permissions:h}=S(Q),c=h.get(j.SKLAD_STOL),[r,f]=m.exports.useState(1),g=[...N.entries()].map((s,E)=>e("div",{className:r===s[0]?"tab-button-active":"tab-button-inactive",onClick:()=>{f(s[0])},role:"button",children:s[1]},E)),p=mt(r);return m.exports.useEffect(()=>{c!=null&&c.Read||n("/")},[c]),d("div",{className:"database-edit-container",children:[e(ft,{justifyContent:"flex-start",children:e(W,{icon:"excel",title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0432 Excel",caption:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0432 Excel",onClick:()=>a()})}),e("div",{className:"tab-header-container",children:g}),p]})}function mt(a){const n=new Map;return n.set(1,e(ht,{})),n.set(2,e(P,{income:!0})),n.set(3,e(P,{income:!1})),n.get(a)||e($,{})}export{St as default};
