import{j as c,b as e,u as y,R as z,a as m,r as x,m as U,I as b,P as B,_ as j,C as $,a3 as A,E as H,T as q,c as J,d as W,a2 as Y}from"./index.9378395d.js";import{l as Z,a as tt,b as et,c as ut,d as nt,e as at,f as it,g as Q,h as G,i as lt,j as ot,k as rt,m as st,n as ct,I as dt}from"./export.1c9f850e.js";function X(a){return c("div",{className:"groupbox",children:[e("div",{className:"groupbox-caption",children:a.caption}),a.children]})}function ft(){var R,V,_,O;const{permissions:a}=y(W),n=a.get(z.SKLAD_STOL),d=m(Z),h=m(tt),r=m(et),s=m(ut),f=m(nt),D=m(at),p=y(it),M=[...new Set(p.map(u=>u.id))],l=y(Q),[{filterId:E,filterMinLength:S,filterMaxLength:I},C]=x.exports.useState({filterId:0,filterMinLength:0,filterMaxLength:4e3}),g=p.filter(u=>((u==null?void 0:u.id)===E||E===0)&&(u==null?void 0:u.length)>=S&&(u==null?void 0:u.length)<=I),[T,v]=x.exports.useState(0),t=[{caption:"\u0421\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0430"},{caption:"\u0414\u043B\u0438\u043D\u0430"},{caption:"\u041A\u043E\u043B-\u0432\u043E"}],o=g.map((u,i)=>({key:i,data:[l.get(u.id),u.length,u.amount]})),K=[{title:"\u0421\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0430:",value:(R=g[T])==null?void 0:R.id,displayValue:u=>l.get(u)||"",message:U.ENTER_CAPTION,inputType:b.LIST,list:[...l.keys()]},{title:"\u0414\u043B\u0438\u043D\u0430:",value:(V=g[T])==null?void 0:V.length,message:U.ENTER_CODE,inputType:b.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER,checkValue:u=>({success:u>0,message:"\u0414\u043B\u0438\u043D\u0430 \u0434\u043E\u043B\u0436\u043D\u0430 \u0431\u044B\u0442\u044C \u0431\u043E\u043B\u044C\u0448\u0435 0"})},{title:"\u041A\u043E\u043B-\u0432\u043E:",value:(_=g[T])==null?void 0:_.amount,inputType:b.TEXT,propertyType:B.INTEGER_POSITIVE_NUMBER,checkValue:u=>({success:u>0,message:"\u041A\u043E\u043B-\u0432\u043E \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0431\u043E\u043B\u044C\u0448\u0435 0"})}];return x.exports.useEffect(()=>{d(),h(),r(!0),r(!1)},[]),c(j,{children:[e("hr",{}),e("br",{}),c(X,{caption:"\u0424\u0438\u043B\u044C\u0442\u0440",children:[e("hr",{}),e($,{value:E,items:M,displayValue:u=>l.get(u),onChange:u=>C(i=>({...i,filterId:u||0})),withEmpty:!0,styles:{width:"fit-content"}}),e("hr",{}),c("div",{className:"d-flex align-items-center gap-1",children:[e("div",{children:"\u0414\u043B\u0438\u043D\u0430 \u043E\u0442"}),e(A,{type:B.INTEGER_POSITIVE_NUMBER,value:S,min:0,max:1e4,setValue:u=>C(i=>({...i,filterMinLength:+u||0})),width:"60px"}),e("div",{children:"\u0434\u043E"}),e(A,{type:B.INTEGER_POSITIVE_NUMBER,value:I,min:0,max:1e4,setValue:u=>C(i=>({...i,filterMaxLength:+u||0})),width:"60px"})]}),e("input",{type:"button",value:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",onClick:()=>C({filterId:0,filterMinLength:0,filterMaxLength:4e3})})]}),e("hr",{}),c(H,{children:[e("div",{children:e(q,{header:t,content:o,onSelectRow:u=>{v(u)}})}),n!=null&&n.Update?e(J,{name:(O=g[T])==null?void 0:O.id,items:K,dontUseCheckBoxes:!0,onUpdate:n!=null&&n.Update?{caption:"\u0423\u0431\u0440\u0430\u0442\u044C \u0441\u043E \u0441\u043A\u043B\u0430\u0434\u0430",question:u=>ht(u),onAction:async(u,i)=>{const L=i[0],k=+i[1],w=+i[2],F=await f({id:L,length:k,amount:w});return v(0),F}}:void 0,onAdd:n!=null&&n.Update?{caption:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u0430 \u0441\u043A\u043B\u0430\u0434",question:u=>pt(u),onAction:async(u,i)=>{const L=i[0],k=+i[1],w=+i[2];return await s({id:L,length:k,amount:w})}}:void 0,onDelete:n!=null&&n.Delete?{caption:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u0432\u0441\u0435 \u0441\u043F\u0438\u0441\u043A\u0438",question:()=>"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u0441\u0435 \u0434\u0430\u043D\u043D\u044B\u0435?",onAction:async(u,i)=>await D()}:void 0}):e("div",{})]})]})}function ht(a){return`\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0443 ${a[0]}     ${a[1]}\u043C\u043C  ${a[2]}\u0448\u0442?`}function pt(a){return`\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0443 ${a[0]}    ${a[1]}\u043C\u043C  ${a[2]}\u0448\u0442?`}function P({income:a}){var v;const n=a?y(rt):y(st),d=y(Q),h=[...new Set(n.map(t=>t.id))],r=n.map(t=>t.date).reduce((t,o)=>t>o?o:t,(v=n[0])==null?void 0:v.date),{filterId:s,filterMinLength:f,filterMaxLength:D,filterMinDate:p,filterMaxDate:M,setFilter:l}=Et(a,r),E=n.filter(t=>((t==null?void 0:t.id)===s||s===0)&&(t==null?void 0:t.length)>=f&&(t==null?void 0:t.length)<=D&&(t==null?void 0:t.date)>=p&&(t==null?void 0:t.date)<=M),S=G(p),I=G(M),C=[{caption:"\u0414\u0430\u0442\u0430"},{caption:"\u0421\u0442\u043E\u043B\u0435\u0448\u043D\u0438\u0446\u0430"},{caption:"\u0414\u043B\u0438\u043D\u0430"},{caption:"\u041A\u043E\u043B-\u0432\u043E"}],g=E.map(t=>({key:t.id,data:[lt(t.date),d.get(t.id),t.length,t.amount]}));return x.exports.useEffect(()=>{l(t=>({...t,filterMinDate:r}))},[r]),c("div",{className:"sklad-container",children:[e("hr",{}),e("br",{}),c(X,{caption:"\u0424\u0438\u043B\u044C\u0442\u0440",children:[e("hr",{}),e($,{value:s,items:h,displayValue:t=>d.get(t),onChange:t=>l(o=>({...o,filterId:t||0})),withEmpty:!0,styles:{width:"fit-content"}}),e("hr",{}),c("div",{className:"d-flex align-items-center gap-1",children:[e("div",{children:"\u0414\u043B\u0438\u043D\u0430 \u043E\u0442"}),e(A,{type:B.INTEGER_POSITIVE_NUMBER,value:f,min:0,max:1e4,setValue:t=>l(o=>({...o,filterMinLength:+t||0})),width:"60px"}),e("div",{children:"\u0434\u043E"}),e(A,{type:B.INTEGER_POSITIVE_NUMBER,value:D,min:0,max:1e4,setValue:t=>l(o=>({...o,filterMaxLength:+t||0})),width:"60px"})]}),c("div",{className:"d-flex align-items-center gap-1 justify-content-stretch",children:[e("input",{type:"date",value:S,onChange:t=>l(o=>({...o,filterMinDate:new Date(t.target.value).valueOf()}))}),e("div",{className:"text-nowrap",children:"<---->"}),e("input",{type:"date",value:I,onChange:t=>l(o=>({...o,filterMaxDate:ot(t.target.value)}))})]}),e("input",{type:"button",value:"\u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C",onClick:()=>l({filterId:0,filterMinLength:0,filterMaxLength:4e3,filterMinDate:r,filterMaxDate:Date.now()})})]}),e("hr",{}),e(q,{header:C,content:g})]})}function Et(a,n){const[{filterId:d,filterMinLength:h,filterMaxLength:r,filterMinDate:s,filterMaxDate:f},D]=x.exports.useState({filterId:0,filterMinLength:0,filterMaxLength:4e3,filterMinDate:n,filterMaxDate:Date.now()}),[{filterId:p,filterMinLength:M,filterMaxLength:l,filterMinDate:E,filterMaxDate:S},I]=x.exports.useState({filterId:0,filterMinLength:0,filterMaxLength:4e3,filterMinDate:n,filterMaxDate:Date.now()});return{filterId:a?d:p,filterMinLength:a?h:M,filterMaxLength:a?r:l,filterMinDate:a?s:E,filterMaxDate:a?f:S,setFilter:a?D:I}}const N=new Map;N.set(1,"\u0421\u043A\u043B\u0430\u0434");N.set(2,"\u041F\u0440\u0438\u0445\u043E\u0434");N.set(3,"\u0420\u0430\u0441\u0445\u043E\u0434");function Mt(){const a=m(ct),[n,d]=x.exports.useState(1),h=[...N.entries()].map((s,f)=>e("div",{className:n===s[0]?"tab-button-active":"tab-button-inactive",onClick:()=>{d(s[0])},role:"button",children:s[1]},f)),r=gt(n);return c("div",{className:"database-edit-container",children:[e(dt,{justifyContent:"flex-start",children:e(Y,{icon:"excel",title:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0432 Excel",caption:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0432 Excel",onClick:()=>a()})}),e("div",{className:"tab-header-container",children:h}),r]})}function gt(a){const n=new Map;return n.set(1,e(ft,{})),n.set(2,e(P,{income:!0})),n.set(3,e(P,{income:!1})),n.get(a)||e(j,{})}export{Mt as default};
