import{u as y,R as W,a as _,r as h,b as Ct,m as S,I as D,j as L,E as Y,c as i,T as J,d as Q,e as O,f as ft,g as St,h as xt,i as j,k as _t,C as Z,l as wt,n as Nt,s as Et,o as mt,p as M,q as ht,A as $,M as tt,D as et,t as Ot,v as F,S as Bt,w as gt,x as vt,W as V,y as ut,P as b,z as It,B as Pt,F as st,G as Lt,H as Mt,J as Ut,K as bt,L as Wt,N as $t,O as Ht,Q as Ft,U as kt,V as Xt,X as Vt,Y as Gt,Z as zt}from"./index.fd584dc0.js";import Yt from"./EditSpecificationDialog.61e2948e.js";function Jt(){var P,f,v,g;const{permissions:p}=y(O),e=p.get(W.MATERIALS_DB),r=_(ft),c=_(St),a=_(xt),l=y(j),d=y(_t),A=h.exports.useMemo(()=>[...l.keys()][0]||0,[l]),[T,R]=h.exports.useState(A),C=Ct(T),x=[{caption:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",sorted:!0},{caption:"\u041A\u043E\u0434",sorted:!0},{caption:"\u0422\u0438\u043F",sorted:!0}],B=[];l.forEach((s,I)=>B.push({key:I,data:[s.name,s.code,d.get(s.char_type_id)]}));const w=[{caption:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435:",value:((P=l.get(T))==null?void 0:P.name)||"",message:S.ENTER_CAPTION,type:D.TEXT},{caption:"\u041A\u043E\u0434:",value:((f=l.get(T))==null?void 0:f.code)||"",message:S.ENTER_CODE,type:D.TEXT},{caption:"\u0422\u0438\u043F:",value:((v=l.get(T))==null?void 0:v.char_type_id)||0,valueCaption:s=>d.get(s)||"",list:[...d.keys()],message:"",type:D.LIST},{caption:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435:",value:C||"",message:S.ENTER_IMAGE,type:D.FILE}];return L(Y,{children:[i("div",{children:i(J,{header:x,content:B,onSelectRow:s=>{R(s)}})}),e!=null&&e.Read?i(Q,{name:(g=l.get(T))==null?void 0:g.name,items:w,onUpdate:e!=null&&e.Update?async(s,I)=>{const N=s[0]?I[0]:"",o=s[1]?I[1]:"",t=s[2]?I[2]:0,u=s[3]?I[3]:"";return await r({id:T,char_type_id:t,name:N,code:o,image:u})}:void 0,onDelete:e!=null&&e.Delete?async()=>{const s=await a(T);return R([...l.keys()][0]||0),s}:void 0,onAdd:e!=null&&e.Create?async(s,I)=>{const N=s[0]?I[0]:"",o=s[1]?I[1]:"",t=s[2]?I[2]:0,u=s[3]?I[3]:"";return await c({name:N,char_type_id:t,code:o,image:u})}:void 0}):i("div",{})]})}function Qt(){var I,N;const{permissions:p}=y(O),e=_(wt),r=_(Nt),c=p.get(W.MATERIALS_DB),a=y(Et),l=y(j),d=y(mt),A=h.exports.useMemo(()=>[...a.keys()][0]||0,[a]),[T,R]=h.exports.useState(A),C=h.exports.useMemo(()=>d.filter(o=>o.id===T),[d,T]),x=h.exports.useMemo(()=>C.filter(o=>o.id===T).map(o=>o.charId),[C,T]),B=[...l.keys()].filter(o=>{var t,u;return((t=l.get(o))==null?void 0:t.char_type_id)===((u=a.get(T))==null?void 0:u.charType)}),w=h.exports.useMemo(()=>x[0]||0,[x]),[P,f]=h.exports.useState(w),v=[{caption:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",sorted:!0},{caption:"\u041A\u043E\u0434",sorted:!0}],g=[];x.forEach(o=>{var t,u;return g.push({key:o,data:[(t=l.get(o))==null?void 0:t.name,(u=l.get(o))==null?void 0:u.code]})});const s=[{caption:"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430:",value:P,valueCaption:o=>{var t;return((t=l.get(o))==null?void 0:t.name)||""},list:B,message:S.ENTER_CAPTION,type:D.LIST}];return h.exports.useEffect(()=>{f(x[0]||0)},[x]),L(Y,{children:[L("div",{children:[i("div",{className:"d-flex flex-nowrap gap-2 align-items-start",children:i(Z,{title:"\u041D\u043E\u043C\u0435\u043D\u043A\u043B\u0430\u0442\u0443\u0440\u0430: ",value:T,items:[...a.keys()],displayValue:o=>{var t;return((t=a.get(o))==null?void 0:t.name)||""},onChange:o=>{R(o)}})}),i("hr",{}),g.length>0&&i(J,{header:v,content:g,onSelectRow:o=>{f(o)}})]}),c!=null&&c.Read?i(Q,{name:((I=a.get(T))==null?void 0:I.name)+""+((N=l.get(P))==null?void 0:N.name),items:s,onDelete:c!=null&&c.Delete?async()=>{const o=await r({id:T,charId:P});return f(x[0]||0),o}:void 0,onAdd:c!=null&&c.Create?async(o,t)=>{const u=t[0];return C.find(U=>U.charId===u)?{success:!1,message:S.MATERIAL_EXIST}:await e({id:T,charId:u})}:void 0}):i("div",{})]})}const Tt=M(new Map),at=M(null,async(p,e)=>{var a;const{token:r,permissions:c}=p(O);if(!((a=c.get(W.MATERIALS))!=null&&a.Read))return{success:!1,message:""};try{const l=await ht(`${$}${tt}${et}?token=${r}`);l.success&&e(Tt,Ot(l.data))}catch(l){console.error(l)}}),Kt=M(null,async(p,e,r)=>{var l;const{token:c,permissions:a}=p(O);if(!((l=a.get(W.MATERIALS))!=null&&l.Delete))return{success:!1,message:""};try{const d=await F(`${$}${tt}${et}`,"DELETE",JSON.stringify({id:r,token:c}));return await e(at),{success:d.success,message:d.message}}catch(d){return console.error(d),{success:!1,message:S.QUERY_ERROR}}}),Zt=M(null,async(p,e,r)=>{var l;const{token:c,permissions:a}=p(O);if(!((l=a.get(W.MATERIALS))!=null&&l.Create))return{success:!1,message:""};try{const d=await F(`${$}${tt}${et}`,"POST",JSON.stringify({data:r,token:c}));return await e(at),{success:d.success,message:d.message}}catch(d){return console.error(d),{success:!1,message:S.QUERY_ERROR}}}),jt=M(null,async(p,e,r)=>{var l;const{token:c,permissions:a}=p(O);if(!((l=a.get(W.MATERIALS))!=null&&l.Update))return{success:!1,message:""};try{const d=await F(`${$}${tt}${et}`,"PUT",JSON.stringify({data:r,token:c}));return await e(at),{success:d.success,message:d.message}}catch(d){return console.error(d),{success:!1,message:S.QUERY_ERROR}}});function qt(){var N;const{permissions:p}=y(O),e=_(at),r=p.get(W.MATERIALS),c=y(Tt),a=y(j),l=y(vt),A=y(mt).filter(o=>o.id===Bt.DSP16).map(o=>o.charId),T=l.filter(o=>o.char_type_id===gt.COLOR).map(o=>o.id),R=()=>c.keys().next().value||0,[C,x]=h.exports.useState(R()),{kromkaId:B,zaglushkaId:w}=c.get(C)||{kromkaId:0,zaglushkaId:0},P=_(Kt),f=_(Zt),v=_(jt),g=[{caption:"\u0414\u0421\u041F",sorted:!0},{caption:"\u041A\u0440\u043E\u043C\u043A\u0430",sorted:!0},{caption:"\u0417\u0430\u0433\u043B\u0443\u0448\u043A\u0430",sorted:!0}],s=[];c.forEach((o,t)=>{var u,E,U;return s.push({key:t,data:[(u=a.get(t))==null?void 0:u.name,(E=a.get(o.kromkaId))==null?void 0:E.name,(U=a.get(o.zaglushkaId))==null?void 0:U.name]})});const I=[{caption:"\u0414\u0421\u041F:",value:C,valueCaption:o=>{var t;return((t=a.get(o))==null?void 0:t.name)||""},message:S.ENTER_CAPTION,type:D.LIST,list:A},{caption:"\u041A\u0440\u043E\u043C\u043A\u0430:",value:B,valueCaption:o=>{var t;return((t=a.get(o))==null?void 0:t.name)||""},message:S.ENTER_CODE,type:D.LIST,list:T},{caption:"\u0417\u0430\u0433\u043B\u0443\u0448\u043A\u0430:",value:w,valueCaption:o=>{var t;return((t=a.get(o))==null?void 0:t.name)||""},message:S.ENTER_CODE,type:D.LIST,list:T}];return h.exports.useEffect(()=>{e()},[r==null?void 0:r.Read]),L(Y,{children:[i(J,{header:g,content:s,onSelectRow:o=>{x(o)}}),r!=null&&r.Read?i(Q,{name:(N=a.get(C))==null?void 0:N.name,items:I,onUpdate:r!=null&&r.Update?async(o,t)=>{const u=o[1]?t[1]:0,E=o[2]?t[2]:0;return await v({id:C,kromkaId:u,zaglushkaId:E})}:void 0,onAdd:r!=null&&r.Create?async(o,t)=>{const u=t[0],E=t[1],U=t[2];return await f({id:u,kromkaId:E,zaglushkaId:U})}:void 0,onDelete:r!=null&&r.Delete?async()=>{const o=await P(C);return x(R()),o}:void 0}):i("div",{})]})}const yt=M([]),nt=M(null,async(p,e)=>{const{token:r}=p(O);try{const c=await ht(`${$}${V}${ut}?token=${r}`);e(yt,c.data)}catch(c){console.error(c)}}),te=M(null,async(p,e,r)=>{const{token:c}=p(O);try{const a=await F(`${$}${V}${ut}`,"POST",JSON.stringify({...r,token:c}));return e(nt),{success:a.success,message:a.message}}catch(a){return console.error(a),{success:!1,message:S.QUERY_ERROR}}}),ee=M(null,async(p,e,r)=>{const{token:c}=p(O);try{const a=await F(`${$}${V}${ut}`,"PUT",JSON.stringify({...r,token:c}));return e(nt),{success:a.success,message:a.message}}catch(a){return console.error(a),{success:!1,message:S.QUERY_ERROR}}}),ue=M(null,async(p,e,r)=>{const{token:c}=p(O);try{const a=await F(`${$}${V}${ut}`,"DELETE",JSON.stringify({id:r,token:c}));return e(nt),{success:a.success,message:a.message}}catch(a){return console.error(a),{success:!1,message:S.QUERY_ERROR}}});function At(){return L("div",{className:"p-3",children:[i("strong",{children:"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u043C\u044B\u0435 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0435:"}),i("div",{children:"W - \u0448\u0438\u0440\u0438\u043D\u0430 \u0448\u043A\u0430\u0444\u0430"}),i("div",{children:"D - \u0433\u043B\u0443\u0431\u0438\u043D\u0430 \u0448\u043A\u0430\u0444\u0430"}),i("div",{children:"H - \u0432\u044B\u0441\u043E\u0442\u0430 \u0448\u043A\u0430\u0444\u0430"}),i("div",{children:"OFFSET - \u043E\u0442\u0441\u0442\u0443\u043F \u0432\u043D\u0443\u0442\u0440\u0435\u043D\u043D\u0435\u0433\u043E \u043D\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F"})]})}function se(){return{detailId:0,length:"",width:"",count:0,id:0,maxHeight:0,maxWidth:0,minHeight:0,minWidth:0,wardrobeId:0}}function ae(){var t;const{permissions:p}=y(O),e=p.get(W.MATERIALS_DB),r=_(nt),c=_(ee),a=_(te),l=_(ue),d=y(It),A=y(Pt),[T,R]=h.exports.useState([...d.keys()][0]),C=y(yt),x=h.exports.useMemo(()=>C.filter(u=>u.wardrobeId===T),[C,T]),B=[...new Set(x.map(u=>u.detailId))],[w,P]=h.exports.useState(0),f=h.exports.useMemo(()=>x.filter(u=>!w||u.detailId===w),[x,w]),[v,g]=h.exports.useState(((t=f.at(0))==null?void 0:t.id)||0),s=f.find(u=>u.id===v)||se(),I=[{caption:"\u0414\u0435\u0442\u0430\u043B\u044C",sorted:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442",sorted:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E",sorted:!0},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442",sorted:!0},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E",sorted:!0},{caption:"\u041A\u043E\u043B-\u0432\u043E",sorted:!0},{caption:"\u0414\u043B\u0438\u043D\u0430",sorted:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430",sorted:!0}],N=f.map(u=>({key:u.id,data:[A.get(u.detailId)||"",u.minWidth,u.maxWidth,u.minHeight,u.maxHeight,u.count,u.length,u.width]})),o=[{caption:"\u0414\u0435\u0442\u0430\u043B\u044C:",value:s.detailId,valueCaption:u=>A.get(u)||"",message:S.ENTER_CAPTION,type:D.LIST,list:[...A.keys()],listWithEmptyRow:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442:",value:s.minWidth,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E:",value:s.maxWidth,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442:",value:s.minHeight,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E:",value:s.maxHeight,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u041A\u043E\u043B-\u0432\u043E:",value:s.count,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0414\u043B\u0438\u043D\u0430:",value:s.length,type:D.TEXT},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430:",value:s.width,type:D.TEXT}];return h.exports.useEffect(()=>{r()},[]),L(Y,{children:[L("div",{children:[i(Z,{value:T,displayValue:u=>d.get(u),items:[...d.keys()],onChange:u=>R(u)}),i("hr",{}),i(Z,{value:w,displayValue:u=>A.get(u),items:B,onChange:u=>P(u),withEmpty:!0}),i("hr",{}),i(J,{header:I,content:N,onSelectRow:u=>{g(u)}})]}),L("div",{children:[e!=null&&e.Read?i(Q,{name:A.get(s==null?void 0:s.detailId),items:o,onUpdate:e!=null&&e.Update?async(u,E)=>{const U=u[0]?E[0]:s.detailId,X=u[1]?+E[1]:s.minWidth,K=u[2]?+E[2]:s.maxWidth,n=u[3]?+E[3]:s.minHeight,m=u[4]?+E[4]:s.maxHeight,H=u[5]?+E[5]:s.count,G=u[6]?E[6]:s.length,z=u[7]?E[7]:s.width;return await c({id:s.id,wardrobeId:s.wardrobeId,detailId:U,maxWidth:K,minWidth:X,minHeight:n,maxHeight:m,count:H,length:G,width:z})}:void 0,onDelete:e!=null&&e.Delete?async()=>{var E;const u=await l(s.id);return g(((E=f.at(0))==null?void 0:E.id)||0),u}:void 0,onAdd:e!=null&&e.Create?async(u,E)=>{const U=u[0]?E[0]:s.detailId,X=u[1]?+E[1]:s.minWidth,K=u[2]?+E[2]:s.maxWidth,n=u[3]?+E[3]:s.minHeight,m=u[4]?+E[4]:s.maxHeight,H=u[5]?+E[5]:s.count,G=u[6]?E[6]:s.length,z=u[7]?E[7]:s.width;return await a({wardrobeId:T,detailId:U,maxWidth:K,minWidth:X,minHeight:n,maxHeight:m,count:H,length:G,width:z})}:void 0}):i("div",{}),i(At,{})]})]})}const Dt=M([]),ot=M(null,async(p,e)=>{const{token:r}=p(O);try{const c=await ht(`${$}${V}${st}?token=${r}`);e(Dt,c.data)}catch(c){console.error(c)}}),ne=M(null,async(p,e,r)=>{const{token:c}=p(O);try{const a=await F(`${$}${V}${st}`,"POST",JSON.stringify({...r,token:c}));return e(ot),{success:a.success,message:a.message}}catch(a){return console.error(a),{success:!1,message:S.QUERY_ERROR}}}),oe=M(null,async(p,e,r)=>{const{token:c}=p(O);try{const a=await F(`${$}${V}${st}`,"PUT",JSON.stringify({...r,token:c}));return e(ot),{success:a.success,message:a.message}}catch(a){return console.error(a),{success:!1,message:S.QUERY_ERROR}}}),re=M(null,async(p,e,r)=>{const{token:c}=p(O);try{const a=await F(`${$}${V}${st}`,"DELETE",JSON.stringify({id:r,token:c}));return e(ot),{success:a.success,message:a.message}}catch(a){return console.error(a),{success:!1,message:S.QUERY_ERROR}}});function ce(){return{charId:0,count:0,id:0,maxDepth:0,maxHeight:0,maxWidth:0,minDepth:0,minHeight:0,minWidth:0,size:"",specId:0,wardrobeId:0}}function ie(){var K;const{permissions:p}=y(O),e=p.get(W.MATERIALS_DB),r=_(ot),c=_(oe),a=_(ne),l=_(re),d=y(It),A=y(Et),T=y(mt),R=y(j),[C,x]=h.exports.useState([...d.keys()][0]),B=y(Dt),w=h.exports.useMemo(()=>B.filter(n=>n.wardrobeId===C),[B,C]),P=[...new Set(w.map(n=>n.specId))],[f,v]=h.exports.useState(0),[g,s]=h.exports.useState(0),I=h.exports.useMemo(()=>w.filter(n=>!f||n.specId===f),[w,f]),[N,o]=h.exports.useState(I[0]&&I[0].id),t=I.find(n=>n.id===N)||ce(),u=h.exports.useMemo(()=>T.filter(n=>g?n.id===g:n.id===(t==null?void 0:t.specId)).map(n=>n.charId),[T,g,t==null?void 0:t.specId]),E=[{caption:"\u0424\u0443\u0440\u043D\u0438\u0442\u0443\u0440\u0430",sorted:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442",sorted:!0},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E",sorted:!0},{caption:"\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u043E\u0442",sorted:!0},{caption:"\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u0434\u043E",sorted:!0},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442",sorted:!0},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E",sorted:!0},{caption:"\u041A\u043E\u043B-\u0432\u043E",sorted:!0},{caption:"\u0420\u0430\u0437\u043C\u0435\u0440",sorted:!0},{caption:"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430",sorted:!0}],U=I.map(n=>{var m,H;return{key:n.id,data:[((m=A.get(n.specId))==null?void 0:m.name)||"",n.minWidth,n.maxWidth,n.minDepth,n.maxDepth,n.minHeight,n.maxHeight,n.count,n.size,((H=R.get(n.charId))==null?void 0:H.name)||""]}}),X=[{caption:"\u0424\u0443\u0440\u043D\u0438\u0442\u0443\u0440\u0430:",value:t.specId,valueCaption:n=>{var m;return((m=A.get(n))==null?void 0:m.name)||""},message:S.ENTER_CAPTION,type:D.LIST,list:[...A.keys()],listWithEmptyRow:!0,onChange:n=>s(n)},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u043E\u0442:",value:t.minWidth,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0428\u0438\u0440\u0438\u043D\u0430 \u0434\u043E:",value:t.maxWidth,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u043E\u0442:",value:t.minDepth,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0413\u043B\u0443\u0431\u0438\u043D\u0430 \u0434\u043E:",value:t.maxDepth,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u043E\u0442:",value:t.minHeight,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u0412\u044B\u0441\u043E\u0442\u0430 \u0434\u043E:",value:t.maxHeight,type:D.TEXT,propertyType:b.INTEGER_POSITIVE_NUMBER},{caption:"\u041A\u043E\u043B-\u0432\u043E:",value:t.count,type:D.TEXT,propertyType:b.POSITIVE_NUMBER},{caption:"\u0420\u0430\u0437\u043C\u0435\u0440:",value:t.size,type:D.TEXT,optional:!0},{caption:"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430:",value:(t==null?void 0:t.charId)||0,valueCaption:n=>{var m;return((m=R.get(n))==null?void 0:m.name)||""},message:S.ENTER_CAPTION,type:D.LIST,list:u,listWithEmptyRow:!0,optional:!0}];return h.exports.useEffect(()=>{r()},[]),h.exports.useEffect(()=>{var n;o(((n=I.at(-1))==null?void 0:n.id)||0),s(0)},[B]),h.exports.useEffect(()=>{var n;o(((n=I.at(0))==null?void 0:n.id)||0),v(0),s(0)},[C]),L(Y,{children:[L("div",{children:[i(Z,{value:C,displayValue:n=>d.get(n),items:[...d.keys()],onChange:n=>x(n)}),i("hr",{}),i(Z,{value:f,displayValue:n=>{var m;return(m=A.get(n))==null?void 0:m.name},items:P,onChange:n=>v(n),withEmpty:!0}),i("hr",{}),i(J,{header:E,content:U,onSelectRow:n=>{o(n)}})]}),L("div",{children:[e!=null&&e.Read?i(Q,{name:((K=A.get(t.specId))==null?void 0:K.name)||"",items:X,onUpdate:e!=null&&e.Update?async(n,m)=>{const H=n[0]?m[0]:t.specId,G=n[1]?+m[1]:t.minWidth,z=n[2]?+m[2]:t.maxWidth,q=n[3]?+m[3]:t.minDepth,rt=n[4]?+m[4]:t.maxDepth,ct=n[5]?+m[5]:t.minHeight,it=n[6]?+m[6]:t.maxHeight,dt=n[7]?+m[7]:t.count,lt=n[8]?m[8]:t.size,pt=n[9]?+m[9]:t.charId;return await c({id:t.id,wardrobeId:C,specId:H,maxWidth:z,minWidth:G,maxDepth:rt,minDepth:q,minHeight:ct,maxHeight:it,count:dt,size:lt,charId:pt})}:void 0,onDelete:e!=null&&e.Delete?async()=>{var m;const n=await l(t.id);return o(((m=I.at(0))==null?void 0:m.id)||0),n}:void 0,onAdd:e!=null&&e.Create?async(n,m)=>{const H=n[0]?m[0]:t.specId,G=n[1]?+m[1]:t.minWidth,z=n[2]?+m[2]:t.maxWidth,q=n[3]?+m[3]:t.minDepth,rt=n[4]?+m[4]:t.maxDepth,ct=n[5]?+m[5]:t.minHeight,it=n[6]?+m[6]:t.maxHeight,dt=n[7]?+m[7]:t.count,lt=n[8]?m[8]:t.size,pt=n[9]?+m[9]:t.charId;return await a({wardrobeId:C,specId:H,maxWidth:z,minWidth:G,maxDepth:rt,minDepth:q,minHeight:ct,maxHeight:it,count:dt,size:lt,charId:pt})}:void 0}):i("div",{}),i(At,{})]})]})}function de(){var N,o;const{permissions:p}=y(O),e=_(Lt);_(Mt);const r=_(Ut),c=y(bt),a=y(Wt),l=p.get(W.MATERIALS_DB),d=y(j),A=y(Et),T=h.exports.useMemo(()=>[...a.keys()][0]||0,[a]),[R,C]=h.exports.useState(T),x=h.exports.useMemo(()=>c.filter(t=>t.id===R),[c,R]),B=h.exports.useMemo(()=>x.filter(t=>t.id===R).map(t=>t.charId),[x,R]),w=[...d.keys()].filter(t=>{var u,E;return((u=d.get(t))==null?void 0:u.char_type_id)===((E=A.get(R))==null?void 0:E.charType)}),P=h.exports.useMemo(()=>B[0]||0,[B]),[f,v]=h.exports.useState(P),g=[{caption:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",sorted:!0},{caption:"\u041A\u043E\u0434",sorted:!0}],s=[];B.forEach(t=>{var u,E;return s.push({key:t,data:[(u=d.get(t))==null?void 0:u.name,(E=d.get(t))==null?void 0:E.code]})});const I=[{caption:"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430:",value:f,valueCaption:t=>{var u;return((u=d.get(t))==null?void 0:u.name)||""},list:w,message:S.ENTER_CAPTION,type:D.LIST}];return h.exports.useEffect(()=>{C(T)},[a]),L(Y,{children:[L("div",{children:[i("div",{className:"d-flex flex-nowrap gap-2 align-items-start",children:i(Z,{title:"\u0422\u0438\u043F \u0444\u0430\u0441\u0430\u0434\u0430: ",value:R,items:[...a.keys()],displayValue:t=>a.get(t)||"",onChange:t=>{C(t)}})}),i("hr",{}),s.length>0&&i(J,{header:g,content:s,onSelectRow:t=>{v(t)}})]}),(l==null?void 0:l.Read)&&s.length>0?i(Q,{name:((N=A.get(R))==null?void 0:N.name)+""+((o=d.get(f))==null?void 0:o.name),items:I,onDelete:l!=null&&l.Delete?async()=>{const t=await r({id:R,charId:f});return v(B[0]||0),t}:void 0,onAdd:l!=null&&l.Create?async(t,u)=>{const E=u[0];return x.find(X=>X.charId===E)?{success:!1,message:S.MATERIAL_EXIST}:await e({id:R,charId:E})}:void 0}):i("div",{})]})}function le(){var f,v;const{permissions:p}=y(O),e=_(Ht),r=_(Ft),c=_(kt),a=y(Xt),l=y(Vt),d=p.get(W.MATERIALS_DB),A=y(j),T=[...A.keys()].filter(g=>{var s;return((s=A.get(g))==null?void 0:s.char_type_id)===gt.COLOR}),[R,C]=h.exports.useState(a[0].charId),x=((f=a.find(g=>g.charId===R))==null?void 0:f.purposeId)||$t.BOTH,B=[{caption:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",sorted:!0},{caption:"\u041A\u043E\u0434",sorted:!0},{caption:"\u041D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",sorted:!0}],w=[];a.forEach(g=>{var s,I;return w.push({key:g.charId,data:[(s=A.get(g.charId))==null?void 0:s.name,(I=A.get(g.charId))==null?void 0:I.code,l.get(g.purposeId)]})});const P=[{caption:"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0430:",value:R,valueCaption:g=>{var s;return((s=A.get(g))==null?void 0:s.name)||""},list:T,message:S.ENTER_CAPTION,type:D.LIST},{caption:"\u041D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435:",value:x,valueCaption:g=>l.get(g)||"",list:[...l.keys()],message:S.ENTER_CAPTION,type:D.LIST}];return h.exports.useEffect(()=>{C(a[0].charId)},[a]),L(Y,{children:[i("div",{children:w.length>0&&i(J,{header:B,content:w,onSelectRow:g=>{C(g)}})}),(d==null?void 0:d.Read)&&w.length>0?i(Q,{name:(v=A.get(R))==null?void 0:v.name,items:P,onDelete:d!=null&&d.Delete?async()=>{const g=await c(R);return C(0),g}:void 0,onAdd:d!=null&&d.Create?async(g,s)=>{const I=s[0],N=s[1];return a.find(t=>t.charId===I)?{success:!1,message:S.MATERIAL_EXIST}:await e({charId:I,purposeId:N})}:void 0,onUpdate:d!=null&&d.Update?async(g,s)=>{const I=s[0],N=s[1];return await r({charId:R,purposeId:x},{charId:I,purposeId:N})}:void 0}):i("div",{})]})}const k=new Map;k.set(1,"\u041D\u043E\u043C\u0435\u043D\u043A\u043B\u0430\u0442\u0443\u0440\u0430");k.set(2,"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0438");k.set(3,"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0438 \u043D\u043E\u043C\u0435\u043D\u043A\u043B\u0430\u0442\u0443\u0440");k.set(4,"\u0425\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A\u0438 \u0444\u0430\u0441\u0430\u0434\u043E\u0432");k.set(5,"\u041D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0445\u0430\u0440\u0430\u043A\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043A");k.set(6,"\u0414\u0421\u041F - \u041A\u0440\u043E\u043C\u043A\u0430 - \u0417\u0430\u0433\u043B\u0443\u0448\u043A\u0430");k.set(7,"\u0414\u0435\u0442\u0430\u043B\u0438\u0440\u043E\u0432\u043A\u0438");k.set(8,"\u0424\u0443\u0440\u043D\u0438\u0442\u0443\u0440\u0430");function he(){const p=Gt(),{permissions:e}=y(O),r=e.get(W.SPECIFICATION),[c,a]=h.exports.useState(1),l=[...k.entries()].map((A,T)=>i("div",{className:c===A[0]?"tab-button-active":"tab-button-inactive",onClick:()=>{a(A[0])},role:"button",children:A[1]},T)),d=pe(c);return h.exports.useEffect(()=>{r!=null&&r.Read||p("/")},[r]),L("div",{className:"database-edit-container",children:[i("div",{className:"tab-header-container",children:l}),d]})}function pe(p){const e=new Map;return e.set(1,i(Yt,{})),e.set(2,i(Jt,{})),e.set(3,i(Qt,{})),e.set(6,i(qt,{})),e.set(7,i(ae,{})),e.set(8,i(ie,{})),e.set(4,i(de,{})),e.set(5,i(le,{})),e.get(p)||i(zt,{})}export{he as default};
